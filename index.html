<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALL„Å§„Å™„Åê BRIDGE - Â§öÁõÆÁöÑ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„Éè„Éñ</title>

    <!-- Icons & Manifest -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' rx='40' fill='%236366F1'/%3E%3Cpath d='M50 70 L70 70 L80 50 L100 50 L110 70 L130 70 L130 130 L50 130 Z' fill='none' stroke='white' stroke-width='12' stroke-linejoin='round'/%3E%3Ccircle cx='90' cy='100' r='20' stroke='white' stroke-width='8' fill='none'/%3E%3C/svg%3E">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' rx='40' fill='%236366F1'/%3E%3Cpath d='M50 70 L70 70 L80 50 L100 50 L110 70 L130 70 L130 130 L50 130 Z' fill='none' stroke='white' stroke-width='12' stroke-linejoin='round'/%3E%3Ccircle cx='90' cy='100' r='20' stroke='white' stroke-width='8' fill='none'/%3E%3C/svg%3E">
    <link rel="manifest" href="data:application/manifest+json,%7B%22name%22%3A%22ALL%E3%81%A4%E3%81%AA%E3%81%90%20BRIDGE%22%2C%22short_name%22%3A%22BRIDGE%22%2C%22description%22%3A%22Multi-purpose%20communication%20hub%20for%20family%2C%20friends%2C%20and%20business.%22%2C%22start_url%22%3A%22.%2Findex.html%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23f0f2f5%22%2C%22theme_color%22%3A%22%236366f1%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%253Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%20180%20180%27%253E%253Crect%20width%3D%27180%27%20height%3D%27180%27%20rx%3D%2740%27%20fill%3D%27%25236366F1%27%2F%253E%253Cpath%20d%3D%27M50%2070%20L70%2070%20L80%2050%20L100%2050%20L110%2070%20L130%2070%20L130%20130%20L50%20130%20Z%27%20fill%3D%27none%27%20stroke%3D%27white%27%20stroke-width%3D%2712%27%20stroke-linejoin%3D%27round%27%2F%253E%253Ccircle%20cx%3D%2790%27%20cy%3D%27100%27%20r%3D%2720%27%20stroke%3D%27white%27%20stroke-width%3D%278%27%20fill%3D%27none%27%2F%253E%253C%2Fsvg%3E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%2C%22purpose%22%3A%22any%22%7D%5D%7D">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for Browser JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&family=Noto+Sans+JP:wght@400;700;900&display=swap');
        
        :root {
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        body {
            font-family: 'Outfit', 'Noto Sans JP', sans-serif;
            background: #f0f2f5;
            overflow-x: hidden;
            min-height: 100vh;
            width: 100%;
            position: relative;
        }

        /* Solid Premium Backgrounds */
        .bg-solid {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            transition: background 1s ease-in-out;
            pointer-events: none;
        }

        .bg-solid.mode-family { background-color: #fdf2f8; }
        .bg-solid.mode-corporate { background-color: #0f172a; }
        .bg-solid.mode-friends { background-color: #faf5ff; }

        /* Modern subtle grid overlay */
        .grid-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(circle, rgba(0,0,0,0.02) 1px, transparent 1px);
            background-size: 32px 32px;
            z-index: -1;
            opacity: 0.5;
            pointer-events: none;
        }
        .mode-corporate .grid-overlay {
            background-image: radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px);
        }

        /* Glassmorphism Classes */
        .glass {
            background: var(--glass-bg);
            -webkit-backdrop-filter: blur(12px);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }

        .premium-btn {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .premium-btn:hover:not(:disabled) {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .premium-btn:active:not(:disabled) {
            transform: translateY(0) scale(0.98);
        }

        /* Component Transitions */
        .page-transition-enter { opacity: 0; transform: scale(0.98) translateY(10px); }
        .page-transition-enter-active { opacity: 1; transform: scale(1) translateY(0); transition: all 500ms cubic-bezier(0.4, 0, 0.2, 1); }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;

        // --- HOOKS: AUTO SAVE ---
        const useAutoSave = (key, initialValue) => {
            const [value, setValue] = useState(() => {
                const saved = localStorage.getItem(`bridge_draft_${key}`);
                return saved ? JSON.parse(saved) : initialValue;
            });
            useEffect(() => {
                localStorage.setItem(`bridge_draft_${key}`, JSON.stringify(value));
            }, [key, value]);
            return [value, setValue];
        };

        // --- UTILS: SHARE & DATA CONVERSION ---
        const dataURLtoFile = (dataurl, filename) => {
            const arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            while(n--) u8arr[n] = bstr.charCodeAt(n);
            return new File([u8arr], filename, {type:mime});
        };

        const compressImage = (file, maxWidth = 1200) => {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const scale = maxWidth / img.width;
                        if (scale < 1) {
                            canvas.width = maxWidth;
                            canvas.height = img.height * scale;
                        } else {
                            canvas.width = img.width;
                            canvas.height = img.height;
                        }
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        resolve(dataURLtoFile(canvas.toDataURL('image/jpeg', 0.8), file.name));
                    };
                };
            });
        };

        const shareContent = async (text, files = []) => {
            const fallback = () => {
                window.location.href = `https://line.me/R/msg/text/?${encodeURIComponent(text)}`;
            };

            try {
                // Ëá™ÂãïÁîªÂÉèÂúßÁ∏Æ
                const compressedFiles = await Promise.all(
                    files.map(f => f.type.startsWith('image/') ? compressImage(f) : Promise.resolve(f))
                );

                const canShareFiles = compressedFiles.length > 0 && navigator.canShare && navigator.canShare({ files: compressedFiles });
                
                const sharePromise = (async () => {
                    if (canShareFiles) {
                        await navigator.share({ files: compressedFiles, title: 'BRIDGE' });
                    } else if (navigator.share) {
                        await navigator.share({ text });
                    } else {
                        throw new Error('Web Share API Not Found');
                    }
                })();

                const timeoutPromise = new Promise((_, reject) => setTimeout(() => reject(new Error('timeout')), 2000));
                await Promise.race([sharePromise, timeoutPromise]);

            } catch (err) {
                if (err.name !== 'AbortError') fallback();
            }
        };

        // --- LUCIDE ICONS WRAPPER ---
        const Icons = {
            Home: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            ),
            Briefcase: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
            ),
            Smile: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>
            ),
            Send: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
            ),
            Image: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
            ),
            Camera: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
            ),
            Zap: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
            ),
            Command: (props) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg>
            )
        };

        /* ==========================================================================
           UI: FAMILY PANEL
           ========================================================================== */
        const FamilyPanel = () => {
            const [draft, setDraft] = useAutoSave('family', { message: '', mood: 'happy', textPos: 'bottom' });
            const [previewUrl, setPreviewUrl] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [fileType, setFileType] = useState('image');

            const handleFileChange = async (e) => {
                if (e.target.files && e.target.files.length > 0) {
                    const files = Array.from(e.target.files);
                    const type = files[0].type.startsWith('video/') ? 'video' : 'image';
                    setFileType(type);
                    setPreviewUrl(URL.createObjectURL(files[0]));
                    setDraft({...draft, mediaFiles: files});
                }
            };

            const simulateSend = async () => {
                const files = draft.mediaFiles;
                if(!draft.message && (!files || files.length === 0)) return;

                setIsGenerating(true);
                try {
                    let fileToShare = files?.[0];
                    if (files && files.length > 1) {
                        const collageUrl = await CollageEngine.createCollage(files);
                        fileToShare = dataURLtoFile(collageUrl, `family_collage_${Date.now()}.jpg`);
                    }

                    if (fileType === 'video' && fileToShare) {
                        await shareContent(`ÂÆ∂Êóè„Å∏ÂãïÁîª„ÇíÈÄÅ‰ø°`, [fileToShare]);
                    } else if (draft.message || draft.mood) {
                        const dataUrl = await FamilyEngine.generateMessageCard(draft.message, draft.mood, fileToShare, draft.textPos);
                        const processed = dataURLtoFile(dataUrl, `family_${Date.now()}.jpg`);
                        const moodText = draft.mood ? (draft.mood === 'happy' ? 'üòä Ê•Ω„Åó„ÅÑ' : draft.mood === 'calm' ? 'üòå „Åæ„Å£„Åü„Çä' : 'ü§© „Çè„Åè„Çè„Åè') : '';
                        await shareContent(`„ÄêÂÆ∂ÊóèÈÄ£Áµ°„Äë ${moodText}`, [processed]);
                    } else if (fileToShare) {
                        await shareContent(`ÂÆ∂Êóè„Å∏ÂÜôÁúü„ÇíÂÖ±Êúâ`, [fileToShare]);
                    }
                } catch (err) {
                    console.error("Share failed:", err);
                } finally {
                    setIsGenerating(false);
                }
            };

            return (
                <div className="glass rounded-[2.5rem] overflow-hidden max-w-2xl mx-auto transition-all">
                    <div className="bg-gradient-to-r from-pink-500/80 to-rose-400/80 p-8 text-white relative">
                        <div className="absolute right-4 top-4 bg-white/20 p-2 rounded-full backdrop-blur-md">
                            <Icons.Home className="w-6 h-6" />
                        </div>
                        <h2 className="text-3xl font-black tracking-tighter">Family Board</h2>
                        <p className="text-xs font-bold opacity-80 uppercase tracking-widest mt-1">Peaceful Connection</p>
                    </div>
                    <div className="p-8 space-y-8">
                        {/* Mood Selector */}
                        <div>
                            <p className="text-[10px] font-black uppercase text-pink-400 mb-3 tracking-widest">Select Mood</p>
                            <div className="flex gap-2">
                                {['none', 'happy', 'calm', 'excited'].map(m => (
                                    <button key={m} onClick={() => setDraft({...draft, mood: m === 'none' ? null : m})} 
                                        className={`flex-1 py-3 rounded-2xl font-bold transition-all text-xs premium-btn ${((m === 'none' && !draft.mood) || draft.mood === m) ? 'bg-pink-500 text-white shadow-lg' : 'bg-gray-100/50 text-gray-500'}`}>
                                        {m === 'none' ? 'üò∂ „Å™„Åó' : m === 'happy' ? 'üòä Ê•Ω„Åó„ÅÑ' : m === 'calm' ? 'üòå „Åæ„Å£„Åü„Çä' : m === 'excited' ? 'ü§© „Çè„Åè„Çè„Åè' : ''}
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Message Input */}
                        <div className="relative">
                            <p className="text-[10px] font-black uppercase text-pink-400 mb-2 tracking-widest">Your Message</p>
                            <textarea className="w-full p-6 bg-pink-50/50 rounded-[2rem] h-40 focus:ring-4 focus:ring-pink-200 outline-none text-gray-700 font-bold text-lg border border-pink-100 shadow-inner resize-none"
                                placeholder="..." value={draft.message} onChange={e => setDraft({...draft, message: e.target.value})} />
                            
                            {/* Text Position Selector */}
                            <div className="absolute bottom-4 right-4 flex gap-1 bg-white/50 backdrop-blur rounded-full p-1 border border-pink-200 shadow-sm">
                                {['top', 'middle', 'bottom'].map(p => (
                                    <button key={p} onClick={() => setDraft({...draft, textPos: p})} 
                                        className={`p-1.5 rounded-full transition-all ${draft.textPos === p ? 'bg-pink-500 text-white' : 'text-pink-300 hover:bg-pink-100'}`}>
                                        <div className={`w-3 h-1 bg-current rounded-full ${p === 'top' ? 'mb-2' : p === 'middle' ? 'my-0.5' : 'mt-2'}`}></div>
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Media Upload */}
                        <div className="flex items-center gap-6">
                            <label className="flex-1">
                                <div className="w-full py-8 glass rounded-[2rem] flex flex-col items-center justify-center gap-2 cursor-pointer hover:bg-white/40 transition-all border-2 border-dashed border-pink-200 premium-btn">
                                    <Icons.Camera className="w-10 h-10 text-pink-300" />
                                    <span className="text-pink-400 font-black text-xs uppercase tracking-widest">Share Moments</span>
                                </div>
                                <input type="file" className="hidden" accept="image/*,video/*" multiple onChange={handleFileChange} />
                            </label>
                            {previewUrl && (
                                <div className="w-32 h-32 rounded-[2rem] overflow-hidden shadow-2xl border-4 border-white transform rotate-3 relative group">
                                    {fileType === 'image' 
                                        ? <img src={previewUrl} className="w-full h-full object-cover" />
                                        : <video src={previewUrl} className="w-full h-full object-cover" muted />
                                    }
                                    {draft.mediaFiles?.length > 1 && (
                                        <div className="absolute top-1 right-1 bg-pink-500 text-white text-[8px] font-black w-5 h-5 rounded-full flex items-center justify-center shadow-lg border border-white">
                                            +{draft.mediaFiles.length - 1}
                                        </div>
                                    )}
                                    <button onClick={() => {setPreviewUrl(null); setDraft({...draft, mediaFiles: []});}} className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity">
                                        <Icons.Zap className="w-8 h-8 text-white rotate-45" />
                                    </button>
                                </div>
                            )}
                        </div>

                        {/* Voice Card Concept */}
                        <div className="bg-pink-50/50 p-4 rounded-3xl flex items-center justify-between border border-pink-100">
                            <div className="flex items-center gap-3">
                                <div className="p-3 bg-pink-100 rounded-2xl text-pink-500">
                                    <Icons.Zap className="w-5 h-5" />
                                </div>
                                <div>
                                    <p className="text-[10px] font-black uppercase tracking-widest text-pink-400">Voice Card</p>
                                    <p className="text-xs font-bold text-gray-500">Èü≥Â£∞„É°„ÉÉ„Çª„Éº„Ç∏„ÇíQR„ÅßÈÄÅ„Çã</p>
                                </div>
                            </div>
                            <button className="px-6 py-2 bg-pink-200 text-pink-600 rounded-full font-black text-[10px] uppercase hover:bg-pink-300 transition-colors">Record (Soon)</button>
                        </div>

                        <button onClick={simulateSend} disabled={isGenerating || (!draft.message && !draft.mood && (!draft.mediaFiles || draft.mediaFiles.length === 0))}
                            className={`w-full py-6 premium-btn ${isGenerating ? 'bg-gray-300' : 'bg-gradient-to-r from-pink-500 to-rose-500 shadow-[0_10px_30px_rgba(244,63,94,0.3)]'} text-white rounded-[2rem] font-black text-xl flex items-center justify-center gap-3`}>
                            {isGenerating ? 'Processing...' : <React.Fragment><Icons.Send className="w-6 h-6" /> Send via LINE</React.Fragment>}
                        </button>
                    </div>
                </div>
            );
        };

        /* ==========================================================================
           LOGIC: CORPORATE ENGINE (Ê•≠ÂãôÁî®Â†±Âëä)
           ========================================================================== */
        class CorporateEngine {
            static async processEvidencePhoto(file, data) {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            canvas.width = 1200; canvas.height = 1200;

                            // 1. Draw Image
                            let sw, sh, sx, sy;
                            const ratio = img.width / img.height;
                            if (ratio > 1) { sh = img.height; sw = img.height; sx = (img.width - img.height) / 2; sy = 0; }
                            else { sw = img.width; sh = img.width; sx = 0; sy = (img.height - img.width) / 2; }
                            ctx.drawImage(img, sx, sy, sw, sh, 0, 0, 1200, 1200);

                            // 2. Terminal Overlay Effect
                            ctx.fillStyle = 'rgba(0, 20, 0, 0.4)';
                            ctx.fillRect(0, 0, 1200, 1200);

                            // Scanlines
                            ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';
                            for(let i=0; i<1200; i+=4) ctx.fillRect(0, i, 1200, 1);

                            // Metadata Sidebar
                            ctx.fillStyle = 'rgba(0, 255, 65, 0.8)';
                            ctx.font = 'bold 24px monospace';
                            
                            const lines = [
                                `> BRIDGE OPS SECURE_FEED`,
                                `> TIMESTAMP: ${data.time.toISOString()}`,
                                `> LATITUDE:  ${data.lat.toFixed(6)}`,
                                `> LONGITUDE: ${data.lng.toFixed(6)}`,
                                `> SPEED:     ${data.speed} KM/H`,
                                `> DEVICE:    MOBILE_UNIT_01`,
                                `--------------------------`,
                                `> STATUS:    VERIFIED_EVIDENCE`
                            ];

                            lines.forEach((line, i) => {
                                ctx.shadowColor = '#00FF41'; ctx.shadowBlur = 10;
                                ctx.fillText(line, 50, 100 + (i * 40));
                            });

                            // Corner Accents
                            ctx.lineWidth = 4; ctx.strokeStyle = '#00FF41';
                            ctx.beginPath(); ctx.moveTo(30, 30); ctx.lineTo(100, 30); ctx.moveTo(30, 30); ctx.lineTo(30, 100); ctx.stroke();
                            ctx.beginPath(); ctx.moveTo(1170, 1170); ctx.lineTo(1100, 1170); ctx.moveTo(1170, 1170); ctx.lineTo(1170, 1100); ctx.stroke();

                            resolve(canvas.toDataURL('image/jpeg', 0.8));
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                });
            }
        }

        class CollageEngine {
            static async createCollage(files) {
                const images = await Promise.all(files.map(f => new Promise(res => {
                    const r = new FileReader();
                    r.onload = (e) => {
                        const i = new Image();
                        i.onload = () => res(i);
                        i.src = e.target.result;
                    };
                    r.readAsDataURL(f);
                })));

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 1200; canvas.height = 1200;
                ctx.fillStyle = '#f8fafc'; ctx.fillRect(0, 0, 1200, 1200);

                const count = images.length;
                const cols = count > 1 ? 2 : 1;
                const rows = Math.ceil(count / cols);
                const w = 1200 / cols; const h = 1200 / rows;

                images.forEach((img, i) => {
                    const x = (i % cols) * w;
                    const y = Math.floor(i / cols) * h;
                    
                    let sw, sh, sx, sy;
                    const cRatio = w / h;
                    const iRatio = img.width / img.height;
                    if (iRatio > cRatio) { sh = img.height; sw = img.height * cRatio; sx = (img.width - sw) / 2; sy = 0; }
                    else { sw = img.width; sh = img.width / cRatio; sx = 0; sy = (img.height - sh) / 2; }
                    
                    ctx.drawImage(img, sx, sy, sw, sh, x, y, w, h);
                    ctx.strokeStyle = 'white'; ctx.lineWidth = 10; ctx.strokeRect(x, y, w, h);
                });

                return canvas.toDataURL('image/jpeg', 0.9);
            }
        }

        /* ==========================================================================
           UI: CORPORATE PANEL
           ========================================================================== */
        const CorporatePanel = () => {
            const [draft, setDraft] = useAutoSave('corporate', { title: '', description: '', urgency: 'medium', location: 'Searching...' });
            const [isProcessing, setIsProcessing] = useState(false);
            const [processedUrl, setProcessedUrl] = useState(null);
            const [processedFile, setProcessedFile] = useState(null);
            const [fileType, setFileType] = useState('image');
            const [gps, setGps] = useState({ lat: 0, lng: 0, speed: 0, city: 'Scanning...' });

            useEffect(() => {
                const watchId = navigator.geolocation.watchPosition(
                    async (pos) => {
                        const { latitude, longitude, speed } = pos.coords;
                        setGps(prev => ({ ...prev, lat: latitude, lng: longitude, speed: Math.floor(speed || 0) * 3.6 }));
                    },
                    (err) => console.error(err),
                    { enableHighAccuracy: true }
                );
                return () => navigator.geolocation.clearWatch(watchId);
            }, []);

            const handlePhoto = async (e) => {
                if (e.target.files && e.target.files.length > 0) {
                    const files = Array.from(e.target.files);
                    setIsProcessing(true);
                    try {
                        const processed = await Promise.all(files.map(async (file, i) => {
                            if (file.type.startsWith('image/')) {
                                const url = await CorporateEngine.processEvidencePhoto(file, { ...gps, time: new Date() });
                                return { 
                                    url, 
                                    file: dataURLtoFile(url, `evidence_${i}_${Date.now()}.jpg`),
                                    type: 'image'
                                };
                            } else {
                                return { 
                                    url: URL.createObjectURL(file), 
                                    file,
                                    type: 'video'
                                };
                            }
                        }));

                        setProcessedUrl(processed[0].url);
                        setFileType(processed[0].type);
                        setProcessedFile(processed.map(p => p.file));
                    } catch (err) {
                        console.error(err);
                    } finally {
                        setIsProcessing(false);
                    }
                }
            };

            const sendReport = () => {
                const urgencyEmoji = draft.urgency === 'high' ? 'üö®„ÄêCRITICAL„Äë' : draft.urgency === 'medium' ? '‚ö†Ô∏è„ÄêCAUTION„Äë' : '‚úÖ„ÄêNORMAL„Äë';
                const text = `${urgencyEmoji} ÁèæÂ†¥„Éá„Ç∏„Çø„É´Â†±Âëä\n` +
                    `ID: #${Math.floor(Date.now()/1000)}\n` +
                    `------------------\n` +
                    `‰ª∂Âêç: ${draft.title}\n` +
                    `Áä∂Ê≥Å: ${draft.description}\n` +
                    `‰ΩçÁΩÆ: LAT ${gps.lat.toFixed(5)}, LNG ${gps.lng.toFixed(5)}\n` +
                    `ÊôÇÂàª: ${new Date().toLocaleTimeString()}\n` +
                    `------------------\n` +
                    `‚ÄªË®ºÊã†„É°„Éá„Ç£„Ç¢Ê∑ª‰ªòÊ∏à„Åø`;
                
                shareContent(text, Array.isArray(processedFile) ? processedFile : (processedFile ? [processedFile] : []));
            };

            return (
                <div className="glass rounded-[2rem] overflow-hidden max-w-2xl mx-auto text-slate-800 border-2 border-slate-300 shadow-2xl">
                    <div className="bg-slate-900 p-8 text-white relative">
                        <div className="absolute right-4 top-4 animate-pulse">
                            <div className="w-3 h-3 bg-red-500 rounded-full shadow-[0_0_10px_#ef4444]"></div>
                        </div>
                        <h2 className="text-2xl font-black uppercase tracking-tighter flex items-center gap-3">
                            <Icons.Briefcase className="w-7 h-7 text-blue-400" /> Ops Report
                        </h2>
                        <div className="mt-4 grid grid-cols-2 gap-4 text-[9px] font-mono text-slate-400">
                            <div className="bg-black/30 p-2 rounded">LOC: {gps.lat.toFixed(4)}, {gps.lng.toFixed(4)}</div>
                            <div className="bg-black/30 p-2 rounded">SPD: {gps.speed} KM/H</div>
                        </div>
                    </div>
                    
                    <div className="p-8 space-y-6">
                        <div className="flex gap-2 bg-slate-100 p-1.5 rounded-2xl">
                            {['low', 'medium', 'high'].map(u => (
                                <button key={u} onClick={() => setDraft({...draft, urgency: u})}
                                    className={`flex-1 py-2 text-[10px] font-black rounded-xl transition-all ${draft.urgency === u ? (u === 'high' ? 'bg-red-600 text-white' : 'bg-slate-800 text-white') : 'text-slate-400'}`}>
                                    {u.toUpperCase()}
                                </button>
                            ))}
                        </div>

                        <input className="w-full bg-white border-2 border-slate-200 p-4 rounded-2xl outline-none focus:border-blue-500 font-bold transition-all shadow-sm"
                            placeholder="Subject / Title" value={draft.title} onChange={e => setDraft({...draft, title: e.target.value})} />
                        
                        <textarea className="w-full bg-white border-2 border-slate-200 p-4 rounded-2xl h-32 outline-none focus:border-blue-500 font-bold transition-all shadow-sm resize-none"
                            placeholder="Detailed Situation Report..." value={draft.description} onChange={e => setDraft({...draft, description: e.target.value})} />

                        <div className="grid grid-cols-2 gap-6">
                            <label className="cursor-pointer">
                                <div className="h-44 glass-dark bg-slate-800 text-white rounded-[2rem] flex flex-col items-center justify-center border-2 border-dashed border-slate-600 premium-btn">
                                    <Icons.Camera className="w-10 h-10 mb-2 opacity-50" />
                                    <span className="text-[10px] font-black uppercase tracking-widest">Capture Evidence</span>
                                </div>
                                <input type="file" className="hidden" accept="image/*,video/*" capture="environment" multiple onChange={handlePhoto} />
                            </label>
                            <div className="h-44 bg-black rounded-[2rem] overflow-hidden border-2 border-slate-800 shadow-inner relative">
                                {isProcessing ? (
                                    <div className="absolute inset-0 flex items-center justify-center">
                                        <div className="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
                                    </div>
                                ) : processedUrl ? (
                                    fileType === 'image' ? (
                                        <div className="relative h-full">
                                            <img src={processedUrl} className="w-full h-full object-cover" />
                                            {processedFile?.length > 1 && (
                                                <div className="absolute bottom-2 right-2 bg-blue-600 text-white text-[10px] font-black px-2 py-1 rounded">+{processedFile.length - 1} FILES</div>
                                            )}
                                        </div>
                                    ) : (
                                        <video src={processedUrl} className="w-full h-full object-cover" controls />
                                    )
                                ) : (
                                    <div className="flex items-center justify-center h-full text-[10px] font-mono text-slate-700">AWAITING INPUT...</div>
                                )}
                            </div>
                        </div>

                        <button onClick={sendReport} disabled={!processedUrl || !draft.title}
                            className={`w-full py-6 premium-btn ${draft.urgency === 'high' ? 'bg-red-600 shadow-red-200' : 'bg-slate-900 shadow-slate-200'} text-white rounded-[2rem] font-black text-xl flex items-center justify-center gap-3 disabled:opacity-30`}>
                            <Icons.Zap className="w-6 h-6" /> SUBMIT REPORT
                        </button>
                    </div>
                </div>
            );
        };

        /* ==========================================================================
           LOGIC: FAMILY ENGINE (ÂÆ∂ÊóèÈÄ£Áµ°)
           ========================================================================== */
        class FamilyEngine {
            static async generateMessageCard(message, mood, originalFile, textPos = 'bottom') {
                return new Promise((resolve, reject) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = 800; canvas.height = 800;

                    const drawBody = (img = null) => {
                        try {
                            const grad = ctx.createLinearGradient(0, 0, 800, 800);
                            grad.addColorStop(0, '#FFF5F7'); grad.addColorStop(1, '#FFE4E8');
                            ctx.fillStyle = grad; ctx.fillRect(0, 0, 800, 800);

                            if (img) {
                                const size = 520;
                                const tx = 140, ty = 140;
                                let sw, sh, sx, sy;
                                const ratio = img.width / img.height;
                                if (ratio > 1) { sh = img.height; sw = img.height; sx = (img.width - img.height) / 2; sy = 0; }
                                else { sw = img.width; sh = img.width; sx = 0; sy = (img.height - img.width) / 2; }
                                
                                ctx.save();
                                ctx.shadowColor = 'rgba(244, 63, 94, 0.2)';
                                ctx.shadowBlur = 40;
                                ctx.beginPath(); ctx.rect(tx, ty, size, size); ctx.clip();
                                ctx.drawImage(img, sx, sy, sw, sh, tx, ty, size, size);
                                ctx.restore();

                                // Stylish border around photo
                                ctx.strokeStyle = 'white'; ctx.lineWidth = 15;
                                ctx.strokeRect(tx, ty, size, size);
                            }
                            
                            if (mood) {
                                ctx.fillStyle = '#E11D48';
                                ctx.font = 'black 50px sans-serif';
                                ctx.textAlign = 'center';
                                const moodIcon = mood === 'happy' ? 'üòä Ê•Ω„Åó„ÅÑ' : mood === 'calm' ? 'üòå „Åæ„Å£„Åü„Çä' : 'ü§© „Çè„Åè„Çè„Åè';
                                // Ê∞óÂàÜ„ÅØÂ∏∏„Å´‰∏äÈÉ®„Å´ÈÖçÁΩÆÔºà„Çµ„Ç§„É≥„ÅÆ„Çà„ÅÜ„Å´Ôºâ
                                ctx.fillText(moodIcon, 400, 90);
                            }

                            if (message) {
                                ctx.fillStyle = '#334155'; ctx.font = 'bold 44px sans-serif'; ctx.textAlign = 'center';
                                const wrapText = (t, x, y, mw, lh) => {
                                    const words = t.split(''); let line = '';
                                    for(let n = 0; n < words.length; n++) {
                                        let test = line + words[n];
                                        if (ctx.measureText(test).width > mw && n > 0) { ctx.fillText(line, x, y); line = words[n]; y += lh; }
                                        else line = test;
                                    }
                                    ctx.fillText(line, x, y);
                                };

                                //Position logic based on textPos
                                let targetY = 720;
                                if (textPos === 'top') targetY = 250;
                                if (textPos === 'middle') targetY = 400;

                                // Shadow for text if overlapping image
                                if (textPos !== 'bottom') {
                                    ctx.shadowColor = 'rgba(255,255,255,0.8)'; ctx.shadowBlur = 10;
                                }
                                wrapText(message, 400, targetY, 700, 55);
                            }

                            // Quality signature
                            ctx.fillStyle = 'rgba(225, 29, 72, 0.3)'; ctx.font = 'bold 12px sans-serif'; ctx.textAlign = 'right';
                            ctx.fillText('BRIDGE PREMIUM MOMENTS', 780, 790);

                            resolve(canvas.toDataURL('image/jpeg', 0.9));
                        } catch (e) { reject(e); }
                    };

                    if (originalFile) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = new Image();
                            img.onload = () => drawBody(img);
                            img.src = e.target.result;
                        };
                        reader.readAsDataURL(originalFile);
                    } else { drawBody(); }
                });
            }
        }

        /* ==========================================================================
           LOGIC: FRIENDS ENGINE (Âèã‰∫∫„ÉªÈÅä„Å≥)
           ========================================================================== */
        class FriendsEngine {
            static async applyPopFilter(file = null, comment = "", filter = "pop") {
                return new Promise((resolve, reject) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = 800; canvas.height = 800;

                    const draw = (img = null) => {
                        try {
                            // Background based on filter
                            const grad = ctx.createLinearGradient(0, 0, 800, 800);
                            if (filter === 'bw') {
                                grad.addColorStop(0, '#1f2937'); grad.addColorStop(1, '#111827');
                            } else if (filter === 'neon') {
                                grad.addColorStop(0, '#000000'); grad.addColorStop(1, '#4c1d95');
                            } else if (filter === 'retro') {
                                grad.addColorStop(0, '#78350f'); grad.addColorStop(1, '#451a03');
                            } else {
                                grad.addColorStop(0, '#8B5CF6'); grad.addColorStop(1, '#EC4899');
                            }
                            ctx.fillStyle = grad; ctx.fillRect(0, 0, 800, 800);

                            if (img) {
                                let sw, sh, sx, sy;
                                const ratio = img.width / img.height;
                                if (ratio > 1) { sh = img.height; sw = img.height; sx = (img.width - img.height) / 2; sy = 0; }
                                else { sw = img.width; sh = img.width; sx = 0; sy = (img.height - img.width) / 2; }
                                
                                ctx.save();
                                if (filter === 'bw') ctx.filter = 'grayscale(100%) brightness(0.9) contrast(1.2)';
                                if (filter === 'retro') ctx.filter = 'sepia(80%) saturate(1.5) contrast(1.1)';
                                if (filter === 'neon') ctx.filter = 'saturate(2) hue-rotate(-20deg) brightness(1.2)';
                                
                                ctx.beginPath(); ctx.rect(100, 100, 600, 500); ctx.clip();
                                ctx.drawImage(img, sx, sy, sw, sh, 100, 100, 600, 500);
                                ctx.restore();
                                
                                // Frame
                                ctx.strokeStyle = 'white'; ctx.lineWidth = filter === 'neon' ? 4 : 10;
                                ctx.strokeRect(100, 100, 600, 500);
                                if (filter === 'neon') {
                                    ctx.strokeStyle = '#22d3ee'; ctx.lineWidth = 15; ctx.globalAlpha = 0.5;
                                    ctx.strokeRect(95, 95, 610, 510); ctx.globalAlpha = 1;
                                }
                            }

                            // Dynamic Text Styles
                            if (comment) {
                                ctx.fillStyle = filter === 'neon' ? '#fbbf24' : 'white';
                                ctx.font = `black ${filter === 'retro' ? 'italic ' : ''}48px sans-serif`;
                                ctx.textAlign = 'center';
                                if (filter === 'neon') {
                                    ctx.shadowColor = '#fbbf24'; ctx.shadowBlur = 15;
                                }
                                const wrapText = (t, x, y, mw, lh) => {
                                    const words = t.split(''); let line = '';
                                    for(let n = 0; n < words.length; n++) {
                                        let test = line + words[n];
                                        if (ctx.measureText(test).width > mw && n > 0) { ctx.fillText(line, x, y); line = words[n]; y += lh; }
                                        else line = test;
                                    }
                                    ctx.fillText(line, x, y);
                                };
                                wrapText(comment, 400, img ? 680 : 400, 700, 60);
                            }

                            // Date Badge
                            ctx.save();
                            ctx.translate(720, 120); ctx.rotate(Math.PI / 6);
                            ctx.fillStyle = filter === 'bw' ? '#ffffff' : '#FDE047'; 
                            ctx.font = '900 32px sans-serif';
                            ctx.fillText(new Date().toLocaleDateString(), 0, 0);
                            ctx.restore();

                            resolve(canvas.toDataURL('image/jpeg', 0.85));
                        } catch (e) { reject(e); }
                    };

                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = new Image();
                            img.onload = () => draw(img);
                            img.src = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    } else { draw(); }
                });
            }
        }

        /* ==========================================================================
           UI: FRIENDS PANEL
           ========================================================================== */
        const FriendsPanel = () => {
            const [draft, setDraft] = useAutoSave('friends', { comment: '', filter: 'pop' });
            const [preview, setPreview] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [fileType, setFileType] = useState('image');

            const handlePhoto = async (e) => {
                if(e.target.files.length > 0) {
                    const files = Array.from(e.target.files);
                    const type = files[0].type.startsWith('video/') ? 'video' : 'image';
                    setFileType(type);
                    setPreview(URL.createObjectURL(files[0]));
                    setDraft({...draft, mediaFiles: files});
                }
            };

            const share = async () => {
                const files = draft.mediaFiles;
                if(!draft.comment && (!files || files.length === 0)) return;

                setIsGenerating(true);
                try {
                    let fileToShare = files?.[0];
                    if (files && files.length > 1) {
                        const collageUrl = await CollageEngine.createCollage(files);
                        fileToShare = dataURLtoFile(collageUrl, `friends_collage_${Date.now()}.jpg`);
                    }

                    if (fileType === 'video' && fileToShare) {
                        await shareContent(`Checkout this vibe! üé¨`, [fileToShare]);
                    } else if (fileToShare || draft.comment) {
                        const dataUrl = await FriendsEngine.applyPopFilter(fileToShare, draft.comment, draft.filter);
                        const processed = dataURLtoFile(dataUrl, `friends_${Date.now()}.jpg`);
                        await shareContent(`Share! üí´`, [processed]);
                    }
                } catch (err) {
                    console.error("Friends share failed:", err);
                } finally {
                    setIsGenerating(false);
                }
            };

            return (
                <div className="glass rounded-[3rem] overflow-hidden max-w-2xl mx-auto transition-all shadow-2xl">
                    <div className="bg-gradient-to-br from-purple-600 via-indigo-500 to-cyan-400 p-10 text-white relative">
                        <div className="absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-bl-full backdrop-blur-3xl"></div>
                        <h2 className="text-4xl font-black italic tracking-tight flex items-center gap-4 relative z-10">
                            <Icons.Zap className="w-10 h-10 fill-yellow-400 stroke-yellow-400" /> CHILL OUT
                        </h2>
                        <p className="text-xs font-black uppercase tracking-[0.3em] mt-2 opacity-80">Social Experience Hub</p>
                    </div>

                    <div className="p-10 space-y-8">
                        {/* Filter Selector */}
                        <div className="flex gap-2 overflow-x-auto pb-2 -mx-2 px-2 scrollbar-none">
                            {['pop', 'retro', 'bw', 'neon'].map(f => (
                                <button key={f} onClick={() => setDraft({...draft, filter: f})}
                                    className={`px-6 py-2 rounded-full text-[10px] font-black uppercase tracking-widest transition-all premium-btn ${draft.filter === f ? 'bg-indigo-600 text-white shadow-lg' : 'bg-gray-100 text-gray-400 hover:bg-indigo-50'}`}>
                                    {f}
                                </button>
                            ))}
                        </div>

                        <div className="relative">
                             <textarea className="w-full bg-purple-50/50 p-8 rounded-[2.5rem] outline-none border-2 border-transparent focus:border-purple-300 font-bold text-xl h-48 resize-none text-indigo-900 shadow-inner"
                                placeholder="What's the plan? ‚ú®" value={draft.comment} onChange={e => setDraft({...draft, comment: e.target.value})} />
                             <div className="absolute -bottom-4 right-8 bg-black text-white px-6 py-2 rounded-full text-xs font-black rotate-2 shadow-xl">POPPIN'!</div>
                        </div>

                        <div className="flex gap-6 items-center">
                             <label className="flex-1">
                                <div className="h-48 glass bg-white/40 rounded-[2.5rem] border-4 border-dashed border-indigo-200 flex flex-col items-center justify-center hover:bg-indigo-50 hover:border-indigo-300 transition-all cursor-pointer premium-btn group">
                                    <Icons.Camera className="w-12 h-12 text-indigo-200 group-hover:text-indigo-400 transition-colors" />
                                    <p className="text-[10px] font-black text-indigo-300 mt-2 uppercase tracking-widest">Snap Moment</p>
                                </div>
                                <input type="file" className="hidden" accept="image/*,video/*" multiple onChange={handlePhoto} />
                             </label>
                             {preview && (
                                <div className="flex-1 h-48 rounded-[2.5rem] overflow-hidden shadow-2xl border-8 border-white transform -rotate-2 relative bg-slate-900 group">
                                    {fileType === 'image' ? <img src={preview} className="w-full h-full object-cover" /> : <video src={preview} className="w-full h-full object-cover" muted />}
                                    {draft.mediaFiles?.length > 1 && (
                                        <div className="absolute top-2 right-2 bg-indigo-600 text-white text-[10px] font-black w-7 h-7 rounded-full flex items-center justify-center shadow-lg border-2 border-white">
                                            +{draft.mediaFiles.length - 1}
                                        </div>
                                    )}
                                    <div className={`absolute inset-0 pointer-events-none opacity-30 mix-blend-overlay ${draft.filter === 'retro' ? 'bg-orange-900' : draft.filter === 'bw' ? 'grayscale' : draft.filter === 'neon' ? 'bg-purple-900' : ''}`}></div>
                                </div>
                             )}
                        </div>

                        <button onClick={share} disabled={isGenerating || (!draft.comment && !draft.mediaFiles?.[0])}
                            className={`w-full py-7 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-[2.5rem] font-black text-2xl premium-btn shadow-[0_15px_40px_rgba(79,70,229,0.4)] flex items-center justify-center gap-4`}>
                            {isGenerating ? 'Vibing...' : <React.Fragment><Icons.Send className="w-8 h-8" /> SHARE VIBES</React.Fragment>}
                        </button>
                    </div>
                </div>
            );
        };

        /* ==========================================================================
           MAIN APP: ALL„Å§„Å™„Åê BRIDGE
           ========================================================================== */
        const App = () => {
            const [mode, setMode] = useState('family'); 

            return (
                <div className={`min-h-screen flex flex-col transition-all duration-1000 mode-${mode}`}>
                    {/* Solid Background Canvas */}
                    <div className={`bg-solid mode-${mode}`}></div>
                    <div className="grid-overlay"></div>

                    <nav className="glass sticky top-0 z-50 px-6 h-24 flex items-center justify-between border-b border-white/20">
                        <div className="flex items-center gap-4">
                            <div className={`p-4 rounded-[1.5rem] transition-all duration-700 shadow-2xl ${mode === 'family' ? 'bg-pink-500 rotate-0' : mode === 'corporate' ? 'bg-slate-900 rotate-[360deg]' : 'bg-indigo-600 -rotate-12'}`}>
                                <Icons.Zap className="w-8 h-8 text-white" />
                            </div>
                            <div className="hidden sm:block">
                                <h1 className="text-2xl font-black tracking-tighter text-slate-900 uppercase">Bridge Elite</h1>
                                <p className="text-[10px] font-black text-slate-500 uppercase tracking-[0.4em] leading-none">v3.0 Premium Hub</p>
                            </div>
                        </div>
                        
                        <div className="flex bg-black/5 backdrop-blur-xl p-1.5 rounded-[2rem] border border-white/40 shadow-xl">
                            {['family', 'corporate', 'friends'].map(m => (
                                <button key={m} onClick={() => setMode(m)} 
                                    className={`px-8 py-3 rounded-full text-[10px] font-black uppercase tracking-widest transition-all ${mode === m ? 'bg-white text-black shadow-lg scale-105' : 'text-slate-500 hover:text-slate-800'}`}>
                                    {m}
                                </button>
                            ))}
                        </div>
                    </nav>

                    <main className="flex-grow p-6 md:p-12">
                        <div className="max-w-4xl mx-auto">
                            <div className="mb-16 text-center">
                                <h3 className={`text-6xl md:text-8xl font-black tracking-tighter mb-4 select-none absolute left-0 right-0 top-32 pointer-events-none uppercase ${mode === 'corporate' ? 'text-white/5' : 'text-slate-900/5'}`}>
                                    {mode}
                                </h3>
                                <div className="h-24"></div>
                            </div>

                            <div className="relative min-h-[600px]">
                                {mode === 'family' && (
                                    <div className="animate-in fade-in slide-in-from-bottom-5 duration-700">
                                        <FamilyPanel />
                                    </div>
                                )}
                                {mode === 'corporate' && (
                                    <div className="animate-in fade-in slide-in-from-bottom-5 duration-700">
                                        <CorporatePanel />
                                    </div>
                                )}
                                {mode === 'friends' && (
                                    <div className="animate-in fade-in slide-in-from-bottom-5 duration-700">
                                        <FriendsPanel />
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>

                    <footer className="py-12 glass-dark text-center border-t border-white/10 mt-20">
                         <p className="text-[10px] font-black tracking-[0.5em] uppercase text-slate-400">
                             ALL „Å§„Å™„Åê BRIDGE v3.0 | NEXT GEN CONNECTIVITY
                         </p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

